import e from "./emailSender.js";
document.addEventListener("DOMContentLoaded", function () {
  var t, a;
  let s,
    n,
    i,
    o,
    r,
    l = {},
    c = 1,
    d = {
      texture: null,
      design: { jacket: {}, pants: {} },
      embroidery: {
        jacket: [],
        pants: { location: null, text: "" },
        threadColor: null,
      },
      measurements: {},
    },
    p,
    m,
    u,
    g,
    h,
    $ = [],
    k = [],
    b = [],
    y = {},
    _,
    v = document.getElementById("embroideryLocationsContainer"),
    f = {
      Back: ["4on2_Back_1", "4on2_Back_2", "4on2_Back_3"],
      Lapels: ["4on2_Lapels_1", "4on2_Lapels_2", "4on2_Lapels_3"],
      Pockets: [
        "4on2_pocket_1",
        "4on2_pocket_2",
        "4on2_pocket_3",
        "4on2_pocket_4",
        "4on2_pocket_5",
        "4on2_pocket_6",
        "4on2_pocket_7",
        "4on2_pocket_8",
      ],
    },
    E = {};
  for (let C in f) E[C] = {};
  let L = {},
    x = document.getElementById("renderCanvas"),
    A = new BABYLON.Engine(x, !0, { preserveDrawingBuffer: !0, stencil: !0 }),
    w = document.getElementById("tooltip"),
    I = !1,
    P = !1,
    M = !1,
    T = !1,
    N = 0,
    S = 0,
    j = "front",
    B = () => {
      ((u = new BABYLON.Scene(A)).clearColor = new BABYLON.Color3(1, 1, 1)),
        (h = new BABYLON.ArcRotateCamera(
          "camera",
          0,
          Math.PI / 2,
          5,
          new BABYLON.Vector3(0, 1, 0),
          u
        )).attachControl(x, !0),
        A.setHardwareScalingLevel(1 / (window.devicePixelRatio || 1));
      let e = new BABYLON.FxaaPostProcess(
        "fxaa",
        1,
        null,
        BABYLON.Texture.BILINEAR_SAMPLINGMODE,
        A
      );
      u.postProcesses.push(e),
        h.inputs.attached.touch &&
          ((h.inputs.attached.touch.pinchPrecision = 30),
          (h.inputs.attached.touch.touchAngularSensibility = 1e4)),
        (h.panningSensibility = 0),
        (h.lowerRadiusLimit = 2.5),
        (h.upperRadiusLimit = 20),
        (h.wheelPrecision = 100),
        new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 1, 0), u);
      let t = new BABYLON.DirectionalLight(
        "dirLight",
        new BABYLON.Vector3(-1, -2, -1),
        u
      );
      (t.position = new BABYLON.Vector3(20, 40, 20)),
        (u.useRightHandedSystem = !0),
        (m = new BABYLON.StandardMaterial("material", u)),
        (g = new BABYLON.TransformNode("parent", u)),
        (_ = new BABYLON.HighlightLayer("hl1", u));
      let a = 0,
        l = () => {
          4 == ++a &&
            ((g.rotation.y = Math.PI / 2),
            (S = N = g.rotation.y),
            (j = "front"),
            Z("./batch1/business/E5101-38.webp"),
            (function e() {
              g.computeWorldMatrix(!0);
              let t = g.getChildMeshes(),
                a = new BABYLON.Vector3(
                  Number.MAX_VALUE,
                  Number.MAX_VALUE,
                  Number.MAX_VALUE
                ),
                s = new BABYLON.Vector3(
                  -Number.MAX_VALUE,
                  -Number.MAX_VALUE,
                  -Number.MAX_VALUE
                );
              t.forEach((e) => {
                e.computeWorldMatrix(!0);
                let t = e.getBoundingInfo(),
                  n = t.boundingBox.minimumWorld,
                  i = t.boundingBox.maximumWorld;
                (a = BABYLON.Vector3.Minimize(a, n)),
                  (s = BABYLON.Vector3.Maximize(s, i));
              });
              let l = a.add(s).scale(0.5);
              (g.position = g.position.subtract(l)),
                h.setTarget(BABYLON.Vector3.Zero());
              let c = s.subtract(a).length();
              (h.radius = 1.5 * c),
                (n = h.radius),
                (i = h.target.clone()),
                (o = h.alpha),
                (r = h.beta),
                (h.upperRadiusLimit = n);
            })(),
            (function e() {
              let t = H;
              if (
                ((H = function (e) {
                  console.log("Camera zoom disabled for default jacket parts.");
                }),
                d.design.jacket.Back ||
                  ((d.design.jacket.Back = f.Back[0]), el("Back", f.Back[0])),
                d.design.jacket.Lapels ||
                  ((d.design.jacket.Lapels = f.Lapels[0]),
                  el("Lapels", f.Lapels[0])),
                window.matchMedia("(max-width: 1024.9px)").matches)
              )
                d.design.jacket.Pockets ||
                  ((d.design.jacket.Pockets = f.Pockets[0]),
                  el("Pockets", f.Pockets[0]));
              else {
                if (!d.design.jacket.PocketsTop) {
                  d.design.jacket.PocketsTop = es[0];
                  let a = E.Pockets[es[0]];
                  a &&
                    (a.setEnabled(!0),
                    (a.renderingGroupId = 2),
                    _.addMesh(a, BABYLON.Color3.White()));
                }
                if (!d.design.jacket.PocketsBottom) {
                  d.design.jacket.PocketsBottom = en[0];
                  let s = E.Pockets[en[0]];
                  s &&
                    (s.setEnabled(!0),
                    (s.renderingGroupId = 2),
                    _.addMesh(s, BABYLON.Color3.White()));
                }
              }
              H = t;
            })(),
            J(c));
        };
      function v(e) {
        return e.startsWith("4on2_Back")
          ? "Back"
          : e.startsWith("4on2_Lapels")
          ? "Lapels"
          : e.startsWith("4on2_pocket")
          ? "Pockets"
          : null;
      }
      BABYLON.SceneLoader.ImportMesh("", "./", "jacket.glb", u, (e) => {
        e.forEach((e) => {
          (e.material = m),
            (e.parent = g),
            $.push(e),
            (e.renderingGroupId = 2),
            (y[e.name] = e);
          let t = v(e.name);
          t && ((L[t] = e), (E[t][e.name] = e)),
            (e.actionManager = new BABYLON.ActionManager(u)),
            e.actionManager.registerAction(
              new BABYLON.ExecuteCodeAction(
                BABYLON.ActionManager.OnPointerOverTrigger,
                function (t) {
                  let a = v(e.name);
                  if (a && L[a]) {
                    let s = L[a];
                    _.addMesh(s, BABYLON.Color3.White()),
                      (x.style.cursor = "pointer"),
                      (w.style.display = "block"),
                      (w.innerHTML = a);
                  }
                }
              )
            ),
            e.actionManager.registerAction(
              new BABYLON.ExecuteCodeAction(
                BABYLON.ActionManager.OnPointerOutTrigger,
                function (t) {
                  let a = v(e.name);
                  if (a && L[a]) {
                    let s = L[a];
                    _.removeMesh(s),
                      (x.style.cursor = "default"),
                      (w.style.display = "none");
                  }
                }
              )
            ),
            e.actionManager.registerAction(
              new BABYLON.ExecuteCodeAction(
                BABYLON.ActionManager.OnPickDownTrigger,
                function (a) {
                  var s, n;
                  (s = t), (n = e.name), el(s, n);
                }
              )
            );
        }),
          l();
      }),
        BABYLON.SceneLoader.ImportMesh("", "./", "pants.glb", u, (e) => {
          e.forEach((e) => {
            (e.renderingGroupId = 2),
              (e.material = m),
              (e.parent = g),
              k.push(e),
              (y[e.name] = e);
          }),
            l();
        });
      let C = new BABYLON.PBRMaterial("mannequinMaterial", u);
      (C.albedoColor = new BABYLON.Color3(0.08, 0.08, 0.08)),
        (C.metallic = 0),
        (C.roughness = 1);
      let I = new BABYLON.PBRMaterial("shoeMaterial", u);
      for (let P in ((I.albedoColor = new BABYLON.Color3(0, 0, 0)),
      (I.metallic = 0.5),
      (I.roughness = 0.5),
      BABYLON.SceneLoader.ImportMesh("", "./", "Mannequin.glb", u, (e) => {
        (s = new BABYLON.TransformNode("mannequinRoot", u)),
          e.forEach((e) => {
            (e.renderingGroupId = 1),
              console.log("Mesh Name:", e.name),
              (e.parent = s),
              b.push(e),
              (e.actionManager = null),
              (e.useVertexColors = !1),
              e.material && e.material.dispose(),
              (e.material = null),
              e.name.includes("unamed_unamedmesh_1") ||
              e.name.includes("Posed__mask_")
                ? (e.material = C)
                : ("shoe_L" === e.name || "shoe_R" === e.name) &&
                  (e.material = I);
          }),
          (s.parent = g),
          (s.scaling = new BABYLON.Vector3(0.01, 0.01, 0.01)),
          (s.position = new BABYLON.Vector3(0, 0, 0)),
          l(),
          p
            ? (p.setEnabled(!0),
              console.log("Shirt already loaded. Ensured it is visible."))
            : BABYLON.SceneLoader.ImportMesh("", "./", "shirt.glb", u, (e) => {
                let t = new BABYLON.StandardMaterial("shirtMaterial", u);
                (t.diffuseColor = new BABYLON.Color3(1, 1, 1)),
                  (t.backFaceCulling = !1),
                  (p = new BABYLON.TransformNode("shirtRoot", u));
                let a = [];
                e.forEach((e) => {
                  e instanceof BABYLON.Mesh &&
                    (console.log("[SHIRT LOAD] Found shirt mesh:", e.name),
                    a.push(e),
                    (e.material = t),
                    (e.parent = p),
                    (e.scaling = new BABYLON.Vector3(1, 1, 1)),
                    (e.rotation = new BABYLON.Vector3(0, 0, 0)),
                    (e.position = new BABYLON.Vector3(0, 0, 0)),
                    "Front_1" === e.name
                      ? (e.renderingGroupId = 2)
                      : "2_Button" == e.name
                      ? (e.renderingGroupId = 2)
                      : (e.renderingGroupId = 1));
                }),
                  (p.parent = s),
                  (p.scaling = new BABYLON.Vector3(1, 1, 0.9)),
                  (p.position = new BABYLON.Vector3(0, 0, 0)),
                  (S = N = p.rotation.y),
                  (j = "front");
                let n = [
                  "1_pleat",
                  "2_Button",
                  "Round_Cuffs",
                  "Front_1",
                  "Sleeves",
                ];
                a.forEach((e) => {
                  n.includes(e.name)
                    ? (e.setEnabled(!0), _.addMesh(e, BABYLON.Color3.White()))
                    : e.setEnabled(!1);
                }),
                  l();
              });
      }),
      f))
        f[P].forEach((e) => {
          if (E[P][e]) return;
          let t = e + ".glb";
          BABYLON.SceneLoader.ImportMesh(
            "",
            "./jacket-seperate-pieces/",
            t,
            u,
            (t) => {
              t.forEach((t) => {
                (t.material = m),
                  (t.parent = g),
                  (E[P][e] = t),
                  (y[t.name] = t),
                  t.setEnabled(!1),
                  (t.actionManager = new BABYLON.ActionManager(u)),
                  t.actionManager.registerAction(
                    new BABYLON.ExecuteCodeAction(
                      BABYLON.ActionManager.OnPickDownTrigger,
                      function (e) {
                        var a, s;
                        (a = P), (s = t.name), el(a, s);
                      }
                    )
                  );
              });
            }
          );
        });
      return (
        (u.onPointerDown = function (e, t) {
          t.hit ||
            (_.removeAllMeshes(),
            document
              .querySelectorAll(".part-item")
              .forEach((e) => e.classList.remove("selected")));
        }),
        (u.onPointerMove = function (e, t) {
          "block" === w.style.display &&
            ((w.style.left = e.clientX + 10 + "px"),
            (w.style.top = e.clientY + 10 + "px"),
            (w.style.zIndex = 999));
        }),
        u.registerBeforeRender(() => {
          var e;
          let t = (e = h.alpha) % (2 * Math.PI);
          t < Math.PI / 4 || t > (7 * Math.PI) / 4
            ? "front" !== j &&
              ((j = "front"), console.log("Orientation changed to Front"))
            : t > (3 * Math.PI) / 4 &&
              t < (5 * Math.PI) / 4 &&
              "back" !== j &&
              ((j = "back"), console.log("Orientation changed to Back"));
        }),
        u
      );
    };
  function O() {
    let e = document.querySelectorAll(".part-option"),
      t = document.querySelectorAll(".part-item");
    e.forEach((e) => {
      e.addEventListener("mouseenter", function () {
        let e = this.getAttribute("data-part-name"),
          t = this.getAttribute("data-mesh-name"),
          a = E[e][t];
        a && _.addMesh(a, BABYLON.Color3.White());
      }),
        e.addEventListener("mouseleave", function () {
          let e = this.getAttribute("data-part-name"),
            t = this.getAttribute("data-mesh-name"),
            a = E[e][t];
          a && _.removeMesh(a);
        });
    }),
      t.forEach((e) => {
        e.addEventListener("mouseenter", function () {
          let e = this.getAttribute("data-part"),
            t = L[e];
          t && _.addMesh(t, BABYLON.Color3.White());
        }),
          e.addEventListener("mouseleave", function () {
            let e = this.getAttribute("data-part"),
              t = L[e];
            t && _.removeMesh(t);
          });
      });
  }
  function H(e) {
    if (!e) {
      console.error("zoomToMesh called with undefined mesh");
      return;
    }
    console.log(`Zooming to mesh: ${e.name}`);
    let t = e.getBoundingInfo(),
      a = t.boundingBox.centerWorld,
      s = 1.5 * t.boundingSphere.radiusWorld;
    u.stopAnimation(h);
    let n = new BABYLON.Animation(
        "cameraRadiusAnim",
        "radius",
        60,
        BABYLON.Animation.ANIMATIONTYPE_FLOAT,
        BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT
      ),
      i = [
        { frame: 0, value: h.radius },
        { frame: 240, value: s },
      ];
    n.setKeys(i),
      n.setEasingFunction(new BABYLON.CubicEase()),
      n
        .getEasingFunction()
        .setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEOUT);
    let o = new BABYLON.Animation(
        "cameraTargetXAnim",
        "target.x",
        60,
        BABYLON.Animation.ANIMATIONTYPE_FLOAT,
        BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT
      ),
      r = new BABYLON.Animation(
        "cameraTargetYAnim",
        "target.y",
        60,
        BABYLON.Animation.ANIMATIONTYPE_FLOAT,
        BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT
      ),
      l = new BABYLON.Animation(
        "cameraTargetZAnim",
        "target.z",
        60,
        BABYLON.Animation.ANIMATIONTYPE_FLOAT,
        BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT
      ),
      c = [
        { frame: 0, value: h.target.x },
        { frame: 240, value: a.x },
      ],
      d = [
        { frame: 0, value: h.target.y },
        { frame: 240, value: a.y },
      ],
      p = [
        { frame: 0, value: h.target.z },
        { frame: 240, value: a.z },
      ];
    o.setKeys(c), r.setKeys(d), l.setKeys(p);
    let m = new BABYLON.CubicEase();
    m.setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEOUT),
      o.setEasingFunction(m),
      r.setEasingFunction(m),
      l.setEasingFunction(m),
      (h.animations = []),
      h.animations.push(n, o, r, l),
      u.beginAnimation(h, 0, 240, !1, 1, () => {
        console.log(`Camera smoothly zoomed to mesh: ${e.name}`);
      });
  }
  function z(e, t) {
    el(e, t);
  }
  function q() {
    let e = g.rotation.y,
      t = e + Math.PI,
      a = new BABYLON.Animation(
        "rotateModel180",
        "rotation.y",
        60,
        BABYLON.Animation.ANIMATIONTYPE_FLOAT,
        BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT
      );
    a.setKeys([
      { frame: 0, value: e },
      { frame: 60, value: t },
    ]),
      u.beginAnimation(g, 0, 60, !1),
      (g.rotation.y = t),
      console.log(`Model rotated 180\xb0 to Y=${t}`);
  }
  function D(e) {
    return "Back" === e
      ? `
    <div class="card_cardContainer" data-test-id="${e}" tabindex="0">
      <div class="card_cardImageContainer">
        <!-- Back Design Images (Assuming 4 options) -->
        <img loading="lazy" class="card_cardImage image-jacket-back"  src="./assets/jacket/back/jacketback.png" alt="Classic Back">
        <!-- Show # of images if you like -->
        <div class="card_itemAmountContainer" data-test-id="item-amount">4</div>
      </div>
      <div class="card_cardDetails">
        <p class="card_cardText" data-test-id="card-text">${e}</p>
      </div>
      <div class="card_arrowIcon">
        <svg
          class="arrow-right"
          xmlns="http://www.w3.org/2000/svg"
          fill="#000000"
          viewBox="0 0 330 330"
          width="30"
          height="30"
        >
          <path
            d="M250.606,154.389l-150-149.996c-5.857-5.858-15.355-5.858-21.213,0.001  
               c-5.857,5.858-5.857,15.355,0.001,21.213l139.393,139.39L79.393,304.394  
               c-5.857,5.858-5.857,15.355,0.001,21.213  
               C82.322,328.536,86.161,330,90,330s7.678-1.464,10.607-4.394  
               l149.999-150.004c2.814-2.813,4.394-6.628,4.394-10.606  
               C255,161.018,253.42,157.202,250.606,154.389z"
          />
        </svg>
      </div>
    </div>
  `
      : "Lapels" === e
      ? `
    <div class="card_cardContainer" data-test-id="${e}" tabindex="0">
      <div class="card_cardImageContainer">
        <!-- Lapel Design Images (Assuming 3 options) -->
        <img loading="lazy" class="card_cardImage image-jacket-lapels"  src="./assets/jacket/lapel/jacketlapel.png" alt="Classic Lapel">
        <div class="card_itemAmountContainer" data-test-id="item-amount">3</div>
      </div>
      <div class="card_cardDetails">
        <p class="card_cardText" data-test-id="card-text">${e}</p>
      </div>
      <div class="card_arrowIcon">
        <svg
          class="arrow-right"
          xmlns="http://www.w3.org/2000/svg"
          fill="#000000"
          viewBox="0 0 330 330"
          width="30"
          height="30"
        >
          <path
            d="M250.606,154.389l-150-149.996c-5.857-5.858-15.355-5.858-21.213,0.001  
               c-5.857,5.858-5.857,15.355,0.001,21.213l139.393,139.39L79.393,304.394  
               c-5.857,5.858-5.857,15.355,0.001,21.213  
               C82.322,328.536,86.161,330,90,330s7.678-1.464,10.607-4.394  
               l149.999-150.004c2.814-2.813,4.394-6.628,4.394-10.606  
               C255,161.018,253.42,157.202,250.606,154.389z"
          />
        </svg>
      </div>
    </div>
  `
      : "Pockets" === e
      ? `
    <div class="card_cardContainer" data-test-id="${e}" tabindex="0">
      <div class="card_cardImageContainer">
        <!-- Pockets Design Images (Assuming 4 options) -->
        <img loading="lazy" class="card_cardImage image-jacket-pockets"  src="./assets/jacket/pockets/jacketpockets.png" alt="Single Pocket">
        <div class="card_itemAmountContainer" data-test-id="item-amount">8</div>
      </div>
      <div class="card_cardDetails">
        <p class="card_cardText" data-test-id="card-text">${e}</p>
      </div>
      <div class="card_arrowIcon">
        <svg
          class="arrow-right"
          xmlns="http://www.w3.org/2000/svg"
          fill="#000000"
          viewBox="0 0 330 330"
          width="30"
          height="30"
        >
          <path
            d="M250.606,154.389l-150-149.996c-5.857-5.858-15.355-5.858-21.213,0.001  
               c-5.857,5.858-5.857,15.355,0.001,21.213l139.393,139.39L79.393,304.394  
               c-5.857,5.858-5.857,15.355,0.001,21.213  
               C82.322,328.536,86.161,330,90,330s7.678-1.464,10.607-4.394  
               l149.999-150.004c2.814-2.813,4.394-6.628,4.394-10.606  
               C255,161.018,253.42,157.202,250.606,154.389z"
          />
        </svg>
      </div>
    </div>
  `
      : "Cut" === e
      ? `
    <div class="card_cardContainer" data-test-id="${e}" tabindex="0">
      <div class="card_cardImageContainer">
        <!-- 4 CUT IMAGES -->
        <img loading="lazy" class="card_cardImage image-pants-cut"  src="./assets/pants/cut/cut1.png" alt="Extra Slim">
        <img loading="lazy" class="card_cardImage image-pants-cut"  src="./assets/pants/cut/cut2.png" alt="Slim">
        <img loading="lazy" class="card_cardImage image-pants-cut"  src="./assets/pants/cut/cut3.png" alt="Straight">
        <img loading="lazy" class="card_cardImage image-pants-cut"  src="./assets/pants/cut/cut4.png" alt="Classic">
        <!-- Show # of images if you like -->
        <div class="card_itemAmountContainer" data-test-id="item-amount">4</div>
      </div>
      <div class="card_cardDetails">
        <p class="card_cardText" data-test-id="card-text">${e}</p>
      </div>
      <div class="card_arrowIcon">
        <svg
          class="arrow-right"
          xmlns="http://www.w3.org/2000/svg"
          fill="#000000"
          viewBox="0 0 330 330"
          width="30"
          height="30"
        >
          <path
            d="M250.606,154.389l-150-149.996c-5.857-5.858-15.355-5.858-21.213,0.001  
               c-5.857,5.858-5.857,15.355,0.001,21.213l139.393,139.39L79.393,304.394  
               c-5.857,5.858-5.857,15.355,0.001,21.213  
               C82.322,328.536,86.161,330,90,330s7.678-1.464,10.607-4.394  
               l149.999-150.004c2.814-2.813,4.394-6.628,4.394-10.606  
               C255,161.018,253.42,157.202,250.606,154.389z"
          />
        </svg>
      </div>
    </div>
  `
      : "Pleat" === e
      ? `
    <div class="card_cardContainer" data-test-id="${e}" tabindex="0">
      <div class="card_cardImageContainer">
        <!-- 5 PLEAT IMAGES -->
        <img loading="lazy" class="card_cardImage image-pants-pleat"  src="./assets/pants/pleat/pleat1.png" alt="Pleat 1">
        <img loading="lazy" class="card_cardImage image-pants-pleat"  src="./assets/pants/pleat/pleat2.png" alt="Pleat 2">
        <img loading="lazy" class="card_cardImage image-pants-pleat"  src="./assets/pants/pleat/pleat3.png" alt="Pleat 3">
        <img loading="lazy" class="card_cardImage image-pants-pleat"  src="./assets/pants/pleat/pleat4.png" alt="Pleat 4">
 
        <!-- Show # of images if you like -->
        <div class="card_itemAmountContainer" data-test-id="item-amount">5</div>
      </div>
      <div class="card_cardDetails">
        <p class="card_cardText" data-test-id="card-text">${e}</p>
      </div>
      <div class="card_arrowIcon">
        <svg
          class="arrow-right"
          xmlns="http://www.w3.org/2000/svg"
          fill="#000000"
          viewBox="0 0 330 330"
          width="30"
          height="30"
        >
          <path
            d="M250.606,154.389l-150-149.996c-5.857-5.858-15.355-5.858-21.213,0.001  
               c-5.857,5.858-5.857,15.355,0.001,21.213l139.393,139.39L79.393,304.394  
               c-5.857,5.858-5.857,15.355,0.001,21.213  
               C82.322,328.536,86.161,330,90,330s7.678-1.464,10.607-4.394  
               l149.999-150.004c2.814-2.813,4.394-6.628,4.394-10.606  
               C255,161.018,253.42,157.202,250.606,154.389z"
          />
        </svg>
      </div>
    </div>
  `
      : `
  <div class="card_cardContainer" data-test-id="${e}" tabindex="0">
    <div class="card_cardImageContainer">
      <!-- Default Images -->
      <img loading="lazy" class="card_cardImage"  src="./batch1/business/E5101-38.webp" alt="E5101-38">
      <img loading="lazy" class="card_cardImage"  src="./batch1/business/E5102-38.webp" alt="E5102-38">
      <img loading="lazy" class="card_cardImage"  src="./batch1/business/E5103-38.webp" alt="E5103-38">
      <img loading="lazy" class="card_cardImage"  src="./batch1/business/E5104-38.webp" alt="E5104-38">
      <div class="card_itemAmountContainer" data-test-id="item-amount">25</div>
    </div>
    <div class="card_cardDetails">
      <p class="card_cardText" data-test-id="card-text">${e}</p>
    </div>
    <div class="card_arrowIcon">
      <svg
        class="arrow-right"
        xmlns="http://www.w3.org/2000/svg"
        fill="#000000"
        viewBox="0 0 330 330"
        width="30"
        height="30"
      >
        <path
          d="M250.606,154.389l-150-149.996c-5.857-5.858-15.355-5.858-21.213,0.001  
             c-5.857,5.858-5.857,15.355,0.001,21.213l139.393,139.39L79.393,304.394  
             c-5.857,5.858-5.857,15.355,0.001,21.213  
             C82.322,328.536,86.161,330,90,330s7.678-1.464,10.607-4.394  
             l149.999-150.004c2.814-2.813,4.394-6.628,4.394-10.606  
             C255,161.018,253.42,157.202,250.606,154.389z"
        />
      </svg>
    </div>
  </div>
`;
  }
  function F() {
    if (void 0 === n || void 0 === i || void 0 === o || void 0 === r) {
      console.error("Initial camera parameters are not set.");
      return;
    }
    BABYLON.Animation.CreateAndStartAnimation(
      "cameraRadiusReset",
      h,
      "radius",
      60,
      120,
      h.radius,
      n,
      BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT
    ),
      BABYLON.Animation.CreateAndStartAnimation(
        "cameraTargetReset",
        h,
        "target",
        60,
        120,
        h.target,
        i,
        BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT
      ),
      BABYLON.Animation.CreateAndStartAnimation(
        "cameraAlphaReset",
        h,
        "alpha",
        60,
        120,
        h.alpha,
        o,
        BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT
      ),
      BABYLON.Animation.CreateAndStartAnimation(
        "cameraBetaReset",
        h,
        "beta",
        60,
        120,
        h.beta,
        r,
        BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT
      ),
      console.log("Camera reset to initial position.");
  }
  function R() {
    let e = document.querySelector("#sidePanel .back-button");
    if (!e) {
      (e = document.createElement("button")).classList.add("back-button"),
        (e.style.marginBottom = "20px"),
        (e.innerHTML = `
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
        <circle cx="9" cy="9" r="9" fill="#EFEFEF"/>
        <path d="M4.64645 8.64645C4.45118 8.84171 4.45118 9.15829 4.64645 9.35355L7.82843 12.5355C8.02369 12.7308 8.34027 12.7308 8.53553 12.5355C8.7308 12.3403 8.7308 12.0237 8.53553 11.8284L5.70711 9L8.53553 6.17157C8.7308 5.97631 8.7308 5.65973 8.53553 5.46447C8.34027 5.2692 8.02369 5.2692 7.82843 5.46447L4.64645 8.64645ZM13 8.5L5 8.5L5 9.5L13 9.5L13 8.5Z" fill="black"/>
      </svg>
      Back
    `),
        e.addEventListener("click", () => {
          F(), J((c = 2)), e.remove();
        });
      let t = document.getElementById("sidePanel");
      t
        ? t.appendChild(e)
        : (console.warn(
            "#sidePanel element not found. Appending to textureContainer instead."
          ),
          textureContainer.appendChild(e));
    }
  }
  function W() {
    console.log(
      "[showMobileLapelsOptions] Displaying lapels design options..."
    );
    let e = document.getElementById("textureContainer");
    e.innerHTML = "";
    let t = document.createElement("button");
    (t.textContent = "Confirm  "),
      t.classList.add("back-to-cat"),
      t.addEventListener("click", () => {
        console.log("[showMobileLapelsOptions] Confirm clicked => returning"),
          Y();
      }),
      e.appendChild(t);
    let a = document.createElement("div");
    (a.id = "mobileLapelsSlider"), a.classList.add("slider-container");
    let s = document.createElement("div");
    s.classList.add("cards-wrapper"),
      [
        {
          src: "./assets/jacket/lapel/jacketlapel.png",
          label: "Classic Lapel",
          meshName: "4on2_Lapels_1",
        },
        {
          src: "./assets/jacket/lapel/jacketlapel.png",
          label: "Slim Lapel",
          meshName: "4on2_Lapels_2",
        },
        {
          src: "./assets/jacket/lapel/jacketlapel.png",
          label: "Wide Lapel",
          meshName: "4on2_Lapels_3",
        },
      ].forEach((e) => {
        let t = document.createElement("div");
        t.classList.add("part-option", "card_cardContainer"),
          t.setAttribute("data-part-name", "Lapels"),
          t.setAttribute("data-mesh-name", e.meshName),
          (t.style.touchAction = "pan-y"),
          (t.style.cursor = "pointer"),
          d.design.jacket.Lapels === e.meshName && t.classList.add("selected");
        let a = document.createElement("div");
        a.classList.add("img-wrapper"), (a.style.touchAction = "pan-y");
        let n = document.createElement("img");
        (n.src = e.src),
          (n.alt = e.label),
          (n.style.touchAction = "pan-y"),
          (n.style.width = "100%"),
          (n.style.height = "auto"),
          a.appendChild(n);
        let i = document.createElement("p");
        (i.textContent = e.label),
          (i.style.touchAction = "pan-y"),
          t.appendChild(a),
          t.appendChild(i),
          t.addEventListener("click", () => {
            console.log(
              "[showMobileLapelsOptions] Chosen lapels option:",
              e.label
            ),
              s.querySelectorAll(".part-option").forEach((e) => {
                e.classList.remove("selected");
              }),
              t.classList.add("selected"),
              (d.design.jacket.Lapels = e.meshName),
              el("Lapels", e.meshName),
              F();
          }),
          s.appendChild(t);
      }),
      a.appendChild(s),
      e.appendChild(a);
  }
  function V() {
    console.log("[showMobileBackOptions] Displaying back view options...");
    let e = document.getElementById("textureContainer");
    e.innerHTML = "";
    let t = document.createElement("button");
    (t.textContent = "Confirm  "),
      t.classList.add("back-to-cat"),
      t.addEventListener("click", () => {
        console.log(
          "[showMobileBackOptions] Confirm button clicked => returning"
        ),
          Y();
      }),
      e.appendChild(t);
    let a = document.createElement("div");
    (a.id = "mobileBackSlider"),
      a.classList.add("slider-container"),
      [
        {
          src: "./assets/jacket/back/jacketback.png",
          label: "Back Option 1",
          meshName: "4on2_Back_1",
        },
        {
          src: "./assets/jacket/back/jacketback.png",
          label: "Back Option 2",
          meshName: "4on2_Back_2",
        },
        {
          src: "./assets/jacket/back/jacketback.png",
          label: "Back Option 3",
          meshName: "4on2_Back_3",
        },
      ].forEach((e) => {
        let t = document.createElement("div");
        t.classList.add("part-option"),
          t.setAttribute("data-part-name", "Back"),
          t.setAttribute("data-mesh-name", e.meshName),
          (t.style.touchAction = "pan-y"),
          (t.style.cursor = "pointer"),
          d.design.jacket.Back === e.meshName && t.classList.add("selected");
        let s = document.createElement("div");
        s.classList.add("img-wrapper"), (s.style.touchAction = "pan-y");
        let n = document.createElement("img");
        (n.src = e.src),
          (n.alt = e.label),
          (n.style.touchAction = "pan-y"),
          (n.style.width = "100%"),
          (n.style.height = "auto"),
          s.appendChild(n);
        let i = document.createElement("p");
        (i.textContent = e.label),
          (i.style.touchAction = "pan-y"),
          t.appendChild(s),
          t.appendChild(i),
          t.addEventListener("click", () => {
            console.log("[showMobileBackOptions] Chosen back option:", e.label),
              a.querySelectorAll(".part-option").forEach((e) => {
                e.classList.remove("selected");
              }),
              t.classList.add("selected"),
              (d.design.jacket.Back = e.meshName),
              el("Back", e.meshName);
          }),
          a.appendChild(t);
      }),
      e.appendChild(a),
      G("#mobileBackSlider");
  }
  function G(e) {
    let t = document.querySelector(e);
    if (!t) {
      console.error(`Slider container "${e}" not found.`);
      return;
    }
    let a = t.querySelector(".cards-wrapper");
    if (!a) {
      console.error(`"cards-wrapper" not found within "${e}".`);
      return;
    }
    let s = gsap.utils.toArray(".part-option.card_cardContainer", a);
    if (0 === s.length) {
      console.error("No cards found within the slider.");
      return;
    }
    ep(s, { paused: !0, draggable: !0, speed: 2, snap: 1, repeat: -1 }),
      (a.dataset.sliderInitialized = "true");
  }
  function U() {
    console.log(
      "[showMobilePocketsOptions] Displaying pocket design options..."
    );
    let e = document.getElementById("textureContainer");
    e.innerHTML = "";
    let t = document.createElement("button");
    (t.textContent = "Confirm"),
      t.classList.add("back-to-cat"),
      t.addEventListener("click", () => {
        console.log(
          "[showMobilePocketsOptions] Confirm button clicked => returning"
        ),
          Y();
      }),
      e.appendChild(t);
    let a = document.createElement("div");
    a.classList.add("top-bottom-pockets-wrapper");
    let s = document.createElement("button");
    (s.textContent = "Top Pockets"),
      s.classList.add("top-bottom-btns"),
      s.addEventListener("click", () => {
        console.log("Top pockets button clicked"), ei("top");
      });
    let n = document.createElement("button");
    (n.textContent = "Bottom Pockets"),
      n.classList.add("top-bottom-btns"),
      n.addEventListener("click", () => {
        console.log("Bottom pockets button clicked"), ei("bottom");
      }),
      a.appendChild(s),
      a.appendChild(n),
      e.appendChild(a);
    let i = document.getElementById("mobilePocketsContainer");
    i
      ? (i.innerHTML = "")
      : (((i = document.createElement("div")).id = "mobilePocketsContainer"),
        e.appendChild(i)),
      ei("top");
  }
  function Y() {
    let e = document.getElementById("textureContainer");
    if (
      ((e.innerHTML = ""),
      R(),
      window.matchMedia("(max-width: 1024.9px)").matches)
    ) {
      let t = "";
      ["Back", "Lapels", "Pockets"].forEach((e) => {
        t += D(e);
      }),
        (e.innerHTML += `
      <div class="cards-wrapper design-options">
        ${t}
      </div>
    `);
      let a = e.querySelectorAll(".design-options .card_cardContainer");
      a.forEach((e) => {
        e.addEventListener("click", () => {
          let t = e.getAttribute("data-test-id");
          console.log(`Clicked on jacket part: ${t}`),
            "Back" === t ? V() : "Lapels" === t ? W() : "Pockets" === t && U();
        });
      });
    } else {
      let s = "";
      ["Back", "Lapels", "Pockets"].forEach((e) => {
        s += D(e);
      }),
        (e.innerHTML += `
      <div class="controls">
        <button class="prevButton">Prev</button>
        <button class="nextButton">Next</button>
      </div>
      <div class="cards-wrapper design-options">
        ${s}
      </div>
    `);
      let n = e.querySelectorAll(".design-options .card_cardContainer");
      n.forEach((e) => {
        e.addEventListener("click", () => {
          let t = e.getAttribute("data-test-id");
          console.log(`Clicked on jacket part: ${t}`),
            "Back" === t ? V() : "Lapels" === t ? W() : "Pockets" === t && U();
        });
      });
    }
  }
  function X() {
    let e = document.getElementById("textureContainer");
    if (
      ((e.innerHTML = ""),
      R(),
      window.matchMedia("(max-width: 1024.9px)").matches)
    ) {
      let t = "";
      ["Cut", "Pleat"].forEach((e) => {
        t += D(e);
      }),
        (e.innerHTML += `
      <div class="design-options">${t}</div>
    `);
      let a = document.querySelectorAll(".design-options .card_cardContainer");
      a.forEach((e) => {
        e.addEventListener("click", () => {
          let t = e.getAttribute("data-test-id");
          console.log("Clicked Pants Part (mobile):", t),
            "Cut" === t
              ? Q()
              : "Pleat" === t &&
                (function e() {
                  console.log(
                    "[showMobilePleatOptions] Displaying pleat options..."
                  );
                  let t = document.getElementById("textureContainer");
                  t.innerHTML = "";
                  let a = document.createElement("button");
                  (a.textContent = "Confirm "),
                    a.classList.add("back-to-cat"),
                    a.addEventListener("click", () => {
                      console.log(
                        "[showMobilePleatOptions] Confirm clicked => returning"
                      ),
                        X();
                    }),
                    t.appendChild(a);
                  let s = document.createElement("div");
                  (s.id = "mobilePleatSlider"),
                    s.classList.add("slider-container");
                  let n = document.createElement("div");
                  n.classList.add("cards-wrapper"),
                    s.appendChild(n),
                    [
                      {
                        src: "./assets/pants/pleat/pleat1.png",
                        label: "Pleat 1",
                      },
                      {
                        src: "./assets/pants/pleat/pleat2.png",
                        label: "Pleat 2",
                      },
                      {
                        src: "./assets/pants/pleat/pleat3.png",
                        label: "Pleat 3",
                      },
                      {
                        src: "./assets/pants/pleat/pleat4.png",
                        label: "Pleat 4",
                      },
                      {
                        src: "./assets/pants/pleat/pleat5.png",
                        label: "Pleat 5",
                      },
                    ].forEach((e) => {
                      let t = document.createElement("div");
                      t.classList.add("card_cardContainer", "part-option"),
                        t.setAttribute("data-part-name", "Pleat"),
                        t.setAttribute("data-mesh-name", e.label),
                        (t.tabIndex = 0),
                        (t.style.touchAction = "pan-y"),
                        (t.style.cursor = "pointer");
                      let a = document.createElement("div");
                      a.classList.add("img-wrapper"),
                        (a.style.touchAction = "pan-y");
                      let s = document.createElement("img");
                      (s.src = e.src),
                        (s.alt = e.label),
                        (s.style.touchAction = "pan-y"),
                        (s.style.width = "100%"),
                        (s.style.height = "auto"),
                        a.appendChild(s);
                      let i = document.createElement("p");
                      (i.textContent = e.label),
                        (i.style.touchAction = "pan-y"),
                        t.appendChild(a),
                        t.appendChild(i),
                        t.addEventListener("click", () => {
                          console.log(
                            "[showMobilePleatOptions] Chosen pleat:",
                            e.label
                          ),
                            n.querySelectorAll(".part-option").forEach((e) => {
                              e.classList.remove("selected");
                            }),
                            t.classList.add("selected"),
                            (d.design.pants.pleat = e.label),
                            el("Pleat", e.label);
                        }),
                        n.appendChild(t);
                    }),
                    t.appendChild(s),
                    G("#mobilePleatSlider");
                })();
        });
      });
    } else
      (e.innerHTML += `
      <button class="accordion" data-category="pants">
        Pants <span class="sign-acc">+</span>
      </button>
      <div class="panel" style="max-height: 0px;">
        <button class="sub_accordion" data-category="cut">
          Cut <span class="sign-acc">+</span>
        </button>
        <div class="sub_panel">
          <!-- your existing "cut" content -->
        </div>
        <button class="sub_accordion" data-category="pleat">
          Pleat <span class="sign-acc">+</span>
        </button>
        <div class="sub_panel">
          <!-- etc. -->
        </div>
        <!-- Add more sub-accordions if needed -->
      </div>
    `),
        O();
  }
  function J(e) {
    !(function e(t) {
      let a = window.matchMedia("(max-width: 1024.9px)").matches;
      if (!a) return;
      let s = document.getElementById("textureContainer");
      if (!s) {
        console.error("Element with ID 'textureContainer' not found.");
        return;
      }
      s.classList.remove(...["step-1", "step-2", "step-3", "step-4", "step-5"]),
        t >= 1 && t <= 5
          ? (s.classList.add(`step-${t}`),
            console.log(`Added class: step-${t}`))
          : console.warn(`Invalid step number: ${t}. Must be between 1 and 5.`);
    })(e);
    let t = document.getElementById("stepTitle"),
      a = document.getElementById("textureContainer"),
      s = document.getElementById("batchSelector"),
      n = document.querySelector("#sidePanel .back-button");
    switch (
      (n &&
        (n.remove(),
        console.log("[initializeStep] Existing back button removed.")),
      (t.innerHTML = ""),
      c)
    ) {
      case 1:
        (t.innerHTML = `
        <p>Here weâ€™ve curated a selection of fabrics that best suits you.</p>
        <p>Please choose your preferred fabric group from the options below to proceed to the next step.</p>
      `),
          (s.style.display = "none"),
          et(),
          (function e() {
            let t = document.getElementById("textureContainer");
            t.innerHTML = "";
            let a = document.createElement("div"),
              s = document.createElement("div");
            (a.className = "cards-wrapper"),
              (s.className = "cards-wrapper-container");
            let n = l["1"];
            if (
              (Object.keys(l).forEach((t, s) => {
                let i = (function t(a, s, n) {
                  let i = document.createElement("div");
                  (i.className = "card_cardContainer"),
                    (i.dataset.testId = a),
                    (i.tabIndex = n + 1);
                  let o = document.createElement("div");
                  o.className = "card_cardImageContainer";
                  let r = l["1"].slice(0, 4);
                  r.forEach((e) => {
                    let t = document.createElement("img");
                    (t.className = "card_cardImage"),
                      (t.loading = "lazy"),
                      (t.src = `./batch1/business/${e}.webp`),
                      (t.alt = e),
                      o.appendChild(t);
                  });
                  let c = document.createElement("div");
                  (c.className = "card_itemAmountContainer"),
                    (c.dataset.testId = "item-amount"),
                    (c.textContent = l["1"].length),
                    o.appendChild(c);
                  let p = document.createElement("div");
                  p.className = "card_cardDetails";
                  let m = document.createElement("p");
                  (m.className = "card_cardText"),
                    (m.dataset.testId = "card-text"),
                    (m.textContent = `Category ${a}`),
                    p.appendChild(m);
                  let u = document.createElement("div");
                  return (
                    (u.className = "card_arrowIcon"),
                    (u.innerHTML = `<svg class="arrow-right" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000" height="800px" width="800px" version="1.1" id="Layer_1" viewBox="0 0 330 330" xml:space="preserve">
    <path id="XMLID_222_" d="M250.606,154.389l-150-149.996c-5.857-5.858-15.355-5.858-21.213,0.001  
       c-5.857,5.858-5.857,15.355,0.001,21.213l139.393,139.39L79.393,304.394c-5.857,5.858-5.857,15.355,0.001,21.213  
       C82.322,328.536,86.161,330,90,330s7.678-1.464,10.607-4.394  
       l149.999-150.004c2.814-2.813,4.394-6.628,4.394-10.606  
       C255,161.018,253.42,157.202,250.606,154.389z"/>
  </svg>`),
                    i.appendChild(o),
                    i.appendChild(p),
                    i.appendChild(u),
                    i.addEventListener("click", () => {
                      (function t(a) {
                        let s = document.getElementById("textureContainer");
                        s.innerHTML = "";
                        let n = document.createElement("button");
                        (n.textContent = "Confirm"),
                          n.classList.add("back-to-cat"),
                          n.addEventListener("click", () => {
                            e();
                          }),
                          s.appendChild(n);
                        let i = l["1"],
                          o = document.createElement("div");
                        if (
                          ((o.className = "cards-wrapper"),
                          i.forEach((e, t) => {
                            let s = (function e(t, a, s) {
                              var n;
                              let i = document.createElement("div");
                              (i.className = "card_cardContainer card_small"),
                                (i.dataset.testId = s),
                                (i.tabIndex = s + 1);
                              let o = document.createElement("div");
                              o.className = "card_cardImageContainer";
                              let r = document.createElement("img");
                              (r.className = "card_cardImage"),
                                (r.loading = "lazy"),
                                (r.src = `./batch1/business/${a}.webp`),
                                (r.alt = a),
                                o.appendChild(r);
                              let l = document.createElement("div");
                              (l.className =
                                "card_infoSpaceContainer card_dark"),
                                (l.dataset.testId = "info-btn"),
                                (l.innerHTML =
                                  '<p class="susu-pcons" translate="no">info</p>'),
                                o.appendChild(l);
                              let c = document.createElement("div");
                              c.className =
                                "card_cardDetails card_hideMobileInfoText";
                              let d = document.createElement("div");
                              (d.className = "card_cardText"),
                                (d.dataset.testId = "card-text"),
                                (d.textContent =
                                  ((n = a),
                                  n.replace(/_/g, " ").replace(".png", "")));
                              let p = document.createElement("div");
                              return (
                                (p.className = "card_cardSubText"),
                                (p.dataset.testId = "card-subtext"),
                                (p.textContent = "$0.00"),
                                c.appendChild(d),
                                c.appendChild(p),
                                i.appendChild(o),
                                i.appendChild(c),
                                i.addEventListener("click", (e) => {
                                  e.stopPropagation(), K(t, a, i);
                                }),
                                i
                              );
                            })(a, e, t);
                            o.appendChild(s);
                          }),
                          s.appendChild(o),
                          eu(),
                          d.texture)
                        ) {
                          let r = d.texture.replace(".png", ""),
                            c = s.querySelector(`img[alt="${r}"]`);
                          c && c.classList.add("selected");
                        } else if (i.length > 0) {
                          let p = i[0],
                            m = s.querySelector(".card_cardContainer");
                          if (m) {
                            let u = m.querySelector(".card_cardImage");
                            if (u) {
                              u.classList.add("selected");
                              let g = Object.keys(l)[0];
                              K(g, p, m);
                            }
                          }
                        }
                      })(a);
                    }),
                    i
                  );
                })(t, n, s);
                a.appendChild(i);
              }),
              t.appendChild(s),
              t.appendChild(a),
              window.matchMedia("(max-width: 1024.9px)").matches && eu(),
              d.texture)
            ) {
              let i = d.texture.replace(".png", ""),
                o = t.querySelector(`img[alt="${i}"]`);
              o && o.classList.add("selected");
            } else if (n.length > 0) {
              let r = n[0],
                c = t.querySelector(".card_cardContainer");
              if (c) {
                let p = c.querySelector(".card_cardImage");
                if (p) {
                  p.classList.add("selected");
                  let m = Object.keys(l)[0];
                  K(m, r, c);
                }
              }
            }
          })(),
          window.matchMedia("(max-width: 1024.9px)").matches,
          (a.style.display = "flex");
        break;
      case 2:
        if (
          ((t.innerHTML = `
          <p>Great choice!</br>Now, letâ€™s move on to designing your garment.</p>
        `),
          (s.style.display = "none"),
          (a.style.display = "flex"),
          a.classList.add("texture-container"),
          window.matchMedia("(max-width: 1024.9px)").matches)
        ) {
          (t.innerHTML += `
            <p>Please choose which garment to design first:</p>
          `),
            (a.innerHTML = `
            <div id="chooseGarmentContainer" style="display: flex; gap: 20px;">
              <div class="card_cardContainer" data-test-id="chooseJacket" tabindex="0">
                <div class="card_cardImageContainer">
                  <img loading="lazy" class="card_cardImage"  src="./assets/jacketandpants/jacket.png" alt="Jacket">
                  <div class="card_itemAmountContainer" data-test-id="item-amount">Jacket</div>
                </div>
                <div class="card_cardDetails">
                  <p class="card_cardText" data-test-id="card-text">Design Jacket</p>
                </div>
              </div>
              <div class="card_cardContainer" data-test-id="choosePants" tabindex="0">
                <div class="card_cardImageContainer">
                  <img loading="lazy" class="card_cardImage"  src="assets/jacketandpants/pant.png" alt="Pants">
                  <div class="card_itemAmountContainer" data-test-id="item-amount">Pants</div>
                </div>
                <div class="card_cardDetails">
                  <p class="card_cardText" data-test-id="card-text">Design Pants</p>
                </div>
              </div>
            </div>
          `);
          let i = document.querySelector('[data-test-id="chooseJacket"]'),
            o = document.querySelector('[data-test-id="choosePants"]');
          i &&
            i.addEventListener("click", () => {
              Y();
            }),
            o &&
              o.addEventListener("click", () => {
                X();
              });
        } else {
          var r;
          (t.innerHTML += `
            <p>Choose from the available options for each key design feature. Letâ€™s start creating your perfect look!</p>
          `),
            (a.innerHTML = `
            <button class="accordion" data-category="jacket">
              Jacket <span class="sign-acc">+</span>
            </button>
            <div class="panel" style="max-height: 0px;">
              ${
                ((r = [
                  { partName: "Back", options: f.Back },
                  { partName: "Lapels", options: f.Lapels },
                  { partName: "Pockets", options: f.Pockets },
                ]),
                r
                  .map((e) => {
                    if ("Pockets" === e.partName) {
                      let t = e.options.filter((e) =>
                          [
                            "4on2_pocket_4",
                            "4on2_pocket_5",
                            "4on2_pocket_6",
                          ].includes(e)
                        ),
                        a = e.options.filter((e) =>
                          [
                            "4on2_pocket_1",
                            "4on2_pocket_2",
                            "4on2_pocket_3",
                            "4on2_pocket_7",
                            "4on2_pocket_8",
                          ].includes(e)
                        );
                      return `
          <div class="part-item" data-part="${e.partName}">
            ${e.partName}
            <div class="part-options">
              <!-- Top Pockets Section -->
              <div class="sub-part top-pockets">
                <h4>Top Pockets</h4>
                ${t
                  .map(
                    (
                      e,
                      t
                    ) => `<button class="part-option" data-part-name="Pockets" data-mesh-name="${e}">
                        Pockets Option ${t + 1}
                      </button>`
                  )
                  .join("")}
              </div>
              <!-- Bottom Pockets Section -->
              <div class="sub-part bottom-pockets">
                <h4>Bottom Pockets</h4>
                ${a
                  .map(
                    (
                      e,
                      t
                    ) => `<button class="part-option" data-part-name="Pockets" data-mesh-name="${e}">
                        Pockets Option ${t + 1}
                      </button>`
                  )
                  .join("")}
              </div>
            </div>
          </div>
        `;
                    }
                    return e.options && e.options.length > 1
                      ? `
          <div class="part-item" data-part="${e.partName}">
            ${e.partName}
            <div class="part-options">
              ${e.options
                .map(
                  (t, a) => `<button class="part-option" data-part-name="${
                    e.partName
                  }" data-mesh-name="${t}">
                      ${e.partName} Option ${a + 1}
                    </button>`
                )
                .join("")}
            </div>
          </div>
        `
                      : `<div class="part-item" data-part="${e.partName}">${e.partName}</div>`;
                  })
                  .join(""))
              }
            </div>

            <button class="accordion" data-category="pants">
              Pants <span class="sign-acc">+</span>
            </button>
            <div class="panel" style="max-height: 0px;">
              <button class="sub_accordion" data-category="cut">
                Cut <span class="sign-acc">+</span>
              </button>
              <div class="sub_panel">
                <!-- 8 images for Cut -->
                <div id="pantsCutContainer" style="display: flex; flex-wrap: wrap; gap: 1rem;">
                  <div class="pants-item">
                    <img loading="lazy" src="./assets/pants/cut/cut1.png" alt="Extra Slim">
                    <p>Extra Slim</p>
                  </div>
                  <div class="pants-item">
                    <img loading="lazy" src="./assets/pants/cut/cut2.png" alt="Slim">
                    <p>Slim</p>
                  </div>
                  <div class="pants-item">
                    <img loading="lazy" src="./assets/pants/cut/cut3.png" alt="Straight">
                    <p>Straight</p>
                  </div>
                  <div class="pants-item">
                    <img loading="lazy" src="./assets/pants/cut/cut4.png" alt="Classic">
                    <p>Classic</p>
                  </div>
                  <div class="pants-item">
                    <img loading="lazy" src="./assets/pants/cut/cut5.png" alt="Relaxed Fit">
                    <p>Relaxed Fit</p>
                  </div>
                  <div class="pants-item">
                    <img loading="lazy" src="./assets/pants/cut/cut6.png" alt="Tapered Leg">
                    <p>Tapered Leg</p>
                  </div>
                  <div class="pants-item">
                    <img loading="lazy" src="./assets/pants/cut/cut7.png" alt="Flat Front">
                    <p>Flat Front</p>
                  </div>
                  <div class="pants-item">
                    <img loading="lazy" src="./assets/pants/cut/cut8.png" alt="Pleated Front">
                    <p>Pleated Front</p>
                  </div>
                  <div class="pants-item">
                    <img loading="lazy" src="./assets/pants/cut/cut9.png" alt="High waist">
                    <p>High waist</p>
                  </div>
                  <div class="pants-item">
                    <img loading="lazy" src="./assets/pants/cut/cut10.png" alt="Low rise">
                    <p>Low rise</p>
                  </div>
                </div>
              </div>

              <button class="sub_accordion" data-category="pleat">
                Pleat <span class="sign-acc">+</span>
              </button>
              <div class="sub_panel">
                 <div id="pantsCutContainer" style="display: flex; flex-wrap: wrap; gap: 1rem;">
                  <div class="pants-item">
                    <img loading="lazy" src="./assets/pants/pleat/pleat1.png" alt="pleat">
                    <p>pleat</p>
                  </div>
                  <div class="pants-item">
                    <img loading="lazy" src="./assets/pants/pleat/pleat2.png" alt="pleat">
                    <p>pleat</p>
                  </div>
                  <div class="pants-item">
                    <img loading="lazy" src="./assets/pants/pleat/pleat3.png" alt="pleat">
                    <p>pleat</p>
                  </div>
                  <div class="pants-item">
                    <img loading="lazy" src="./assets/pants/pleat/pleat4.png" alt="pleat">
                    <p>pleat</p>
                  </div>
                  <div class="pants-item">
                    <img loading="lazy" src="./assets/pants/pleat/pleat5.png" alt="pleat">
                    <p>pleat</p>
                  </div>
                </div>
              </div>
            </div>
          `),
            O();
        }
        break;
      case 3:
        t.innerHTML = `
        <p>Now itâ€™s time to add a personal touch to your garment!</p>
        <p>You can customize your suit with embroidery. Please select your preferred locations for the embroidery or choose "No Embroidery" to skip.</p>
      `;
        let p = window.matchMedia("(max-width: 1024.9px)").matches,
          m = `
        <h2 class="text-step3">Jacket Embroidery Locations</h2>
        <div id="embroideryLocationsContainer">
          <!-- Embroidery Choices -->
          <div class="choice-container-step3" id="embroideryChoices">
            <div class="jacket-embroidery-choice">
              <img loading="lazy" src="./assets/embroidery/behind-your-lapel.png" alt="Inner right chest pocket"/>
              <p>Inner right chest pocket</p>
            </div>
            <div class="jacket-embroidery-choice">
              <img loading="lazy" src="./assets/embroidery/inner-left-embroidery.png" alt="Inner left chest pocket"/>
              <p>Inner left chest pocket</p>
            </div>
            <div class="jacket-embroidery-choice">
              <img loading="lazy" src="./assets/embroidery/inner-right-embroidery.png" alt="Under the collar flap"/>
              <p>Under the collar flap</p>
            </div>
            <!-- "No Embroidery" Option -->
            <div class="jacket-embroidery-choice no-embroidery">
              <img loading="lazy" src="./assets/rectangle_115.webp" alt="No Embroidery"/>
              <p>No Embroidery</p>
            </div>
          </div>
      `;
        if (
          (p &&
            (m += `
          <!-- Color Choices (created only on mobile) -->
          <div class="color-options hidden" id="colorChoices">
          <span class="mobile-colors">
            <button class="color-option" data-color="#FF0000" style="background-color: #7A1313;"></button>
          </span>
          <span class="mobile-colors">
            <button class="color-option" data-color="#00FF00" style="background-color: #000000;"></button>
          </span>
          <span class="mobile-colors">
            <button class="color-option" data-color="#0000FF" style="background-color: #FFFFFF;"></button>
          </span>
          </div>
        `),
          (m += "</div>"),
          p &&
            (m += `
          <div class="mobile-embroidery-buttons">
            <button id="locationButton" class="embroidery-button">Location</button>
            <button id="colorButton" class="embroidery-button">Color</button>
            <button id="charactersButton" class="embroidery-button">Characters</button>
          </div>
        `),
          (a.innerHTML = m),
          d.embroidery.jacket.length > 0)
        )
          d.embroidery.jacket.forEach((e) => {
            let t = Array.from(
              document.querySelectorAll(".jacket-embroidery-choice")
            ).find((t) => t.querySelector("p").innerText.trim() === e.location);
            t && t.classList.add("selected");
          });
        else {
          let u = document.querySelector(
            ".jacket-embroidery-choice.no-embroidery"
          );
          u && u.classList.add("selected");
        }
        window.matchMedia("(max-width: 1024.9px)").matches &&
          (function e() {
            let t = document.getElementById("locationButton"),
              a = document.getElementById("colorButton"),
              s = document.getElementById("charactersButton"),
              n = document.getElementById("embroideryChoices"),
              i = [t, a, s];
            function o(e) {
              i.forEach((e) => e?.classList.remove("active")),
                e.classList.add("active");
            }
            t &&
              t.addEventListener("click", () => {
                o(t);
                let e = document.getElementById("colorChoices"),
                  a = document.querySelector(".characters-inputs");
                n && n.classList.remove("hidden"),
                  e && e.classList.add("hidden"),
                  a && (a.style.display = "none"),
                  event.stopPropagation();
              }),
              a &&
                a.addEventListener("click", () => {
                  o(a);
                  let e = document.getElementById("colorChoices"),
                    t = document.querySelector(".characters-inputs");
                  n && n.classList.add("hidden"),
                    e && e.classList.remove("hidden"),
                    t && (t.style.display = "none"),
                    event.stopPropagation();
                }),
              s &&
                s.addEventListener("click", () => {
                  o(s), n && n.classList.add("hidden");
                  let e = document.getElementById("colorChoices");
                  e && e.classList.add("hidden");
                  let t = d.embroidery.jacket;
                  if (0 === t.length) {
                    alert("No embroidery locations chosen.");
                    return;
                  }
                  eg();
                  let a = document.querySelector(".characters-inputs");
                  a && (a.style.display = "block"), event.stopPropagation();
                });
            let r = document.getElementById("colorChoices");
            if (r) {
              let l = r.querySelectorAll(".color-option");
              l.forEach((e) => {
                e.addEventListener("click", (t) => {
                  l.forEach((e) => e.classList.remove("selected")),
                    e.classList.add("selected");
                  let a = e.getAttribute("data-color");
                  (d.embroidery.threadColor = a),
                    d.embroidery.jacket &&
                      d.embroidery.jacket.length > 0 &&
                      d.embroidery.jacket.forEach((e) => {
                        e.color = a;
                      }),
                    console.log("Mobile embroidery thread color selected:", a),
                    t.stopPropagation();
                });
              });
            }
            window.matchMedia("(max-width: 1024.9px)").matches ||
              document.addEventListener("click", (e) => {
                let i = document.getElementById("embroideryLocationsContainer");
                if (!i) {
                  console.error(
                    "Element with ID 'embroideryLocationsContainer' not found."
                  );
                  return;
                }
                let o =
                  i.contains(e.target) ||
                  (t && t.contains(e.target)) ||
                  (a && a.contains(e.target)) ||
                  (s && s.contains(e.target));
                if (!o) {
                  n.classList.add("hidden");
                  let r = document.getElementById("colorChoices");
                  r && r.classList.add("hidden");
                }
              });
          })(),
          et(!1),
          k.forEach((e) => e.setEnabled(!0)),
          _.removeAllMeshes();
        break;
      case 4:
        if (
          window.matchMedia("(max-width: 1024.9px)").matches ||
          !d.embroidery.jacket ||
          0 === d.embroidery.jacket.length
        ) {
          J((c = 5));
          return;
        }
        (t.innerHTML = `
        <p>Customize your jacket embroidery!</p>
        <p>Please enter your desired text and select your preferred color for each embroidery location.</p>
      `),
          (s.style.display = "none"),
          (a.style.display = "flex"),
          (a.style.padding = "0 20px"),
          (a.style.justifyContent = "start"),
          (a.innerHTML = `
        <h2 class="text-step3 step4 embroidery">Jacket Embroidery Customization</h2>
        <div id="embroideryCustomizationContainer"></div>
      `);
        let g = document.getElementById("embroideryCustomizationContainer");
        d.embroidery.jacket.forEach((e, t) => {
          g.innerHTML += `
          <div class="embroidery-customization" data-index="${t}">
            <h3>Embroidery ${t + 1}: ${e.location}</h3>
            <button class="remove-embroidery-button" data-index="${t}">Remove</button>
            <div class="embroidery-color-and-text">
              <div class="jacket-embroidery-choice">
                <img loading="lazy" class="embroidery-image" src="./assets/rectangle_115.webp" alt="${
                  e.location
                }">
                <p>${e.location}</p>
              </div>
              <div class="embroidery-color-and-text-input">
                <div class="embroidery-color-picker">
                  <label>Select Color:</label>
                  <div id="embroidery-thread-colors-picker-jacket-${t}" class="color-picker-container">
                    ${(function e(t) {
                      let a = ["#000000", "#FFFFFF", "#7A1313"];
                      return a
                        .map(
                          (e) => `
      <div class="color-circle ${
        d.embroidery.threadColor === e ? "selected" : ""
      }" 
           data-color="${e}" 
           style="background-color: ${e};">
      </div>
    `
                        )
                        .join("");
                    })(21)}
                  </div>
                </div>
                <div class="embroidery-text-input">
                  <label>Enter Text (max 20 characters):</label>
                  <input
                    type="text"
                    id="embroideryTextInput${t}"
                    maxlength="20"
                    placeholder="Your text here"
                    value="${e.text}"
                  />
                </div>
              </div>
            </div>
          </div>
        `;
        }),
          d.embroidery.jacket.forEach((e, t) => {
            let a = document.getElementById(
              `embroidery-thread-colors-picker-jacket-${t}`
            );
            if (a) {
              let s = a.querySelectorAll(".color-circle");
              s.forEach((a) => {
                a.addEventListener("click", () => {
                  s.forEach((e) => e.classList.remove("selected")),
                    a.classList.add("selected"),
                    (d.embroidery.jacket[t].color =
                      a.getAttribute("data-color"));
                }),
                  e.color &&
                    e.color === a.getAttribute("data-color") &&
                    a.classList.add("selected");
              });
            }
            let n = document.getElementById(`embroideryTextInput${t}`);
            n &&
              n.addEventListener("input", () => {
                d.embroidery.jacket[t].text = n.value.trim();
              });
            let i = document.querySelector(
              `.remove-embroidery-button[data-index="${t}"]`
            );
            i &&
              i.addEventListener("click", () => {
                d.embroidery.jacket.splice(t, 1), J(4);
              });
          });
        break;
      case 5:
        (t.innerHTML = `
        <p>Please provide your measurements for the pants.</p>
        <p>Enter your measurements in the fields provided. If you need assistance, refer to the diagram.</p>
      `),
          (s.style.display = "none"),
          (a.style.display = "flex"),
          (a.style.padding = "0 20px"),
          (a.style.justifyContent = "center"),
          (a.innerHTML = `
        <div id="pantsMeasurementWrapper">
          <img loading="lazy" id="pantsMeasurementImage" src="assets/pants/pants.png" alt="Pants Diagram">
          <!-- Measurement inputs will be positioned over this image -->
          ${[
            "Waist",
            "Crotch Depth",
            "Seat",
            "Knee",
            "Inseam",
            "Hips",
            "Thigh",
            "Outseam",
            "Ankle",
          ]
            .map(
              (e) => `
        <div class="measurement-input" id="${e.replace(/\s/g, "")}Measurement">
          <label for="${e}Input">${e}</label>
          <input type="number" id="${e}Input" />
          <div class="line"></div>
          <svg xmlns="http://www.w3.org/2000/svg" width="9" height="9" viewBox="0 0 9 9" fill="none">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M4.5 0.692308C2.39707 0.692308 0.692308 2.39707 0.692308 4.5C0.692308 6.60291 2.39707 8.30769 4.5 8.30769C6.60291 8.30769 8.30769 6.60291 8.30769 4.5C8.30769 2.39707 6.60291 0.692308 4.5 0.692308ZM0 4.5C0 2.01472 2.01472 0 4.5 0C6.98529 0 9 2.01472 9 4.5C9 6.98529 6.98529 9 4.5 9C2.01472 9 0 6.98529 0 4.5ZM4.5 4.15385C4.69117 4.15385 4.84615 4.30883 4.84615 4.5V6.11538C4.84615 6.30655 4.69117 6.46154 4.5 6.46154C4.30883 6.46154 4.15385 6.30655 4.15385 6.11538V4.5C4.15385 4.30883 4.30883 4.15385 4.5 4.15385ZM4.5 2.65385C4.24509 2.65385 4.03846 2.86049 4.03846 3.11538C4.03846 3.37028 4.24509 3.57692 4.5 3.57692H4.50462C4.75952 3.57692 4.96615 3.37028 4.96615 3.11538C4.96615 2.86049 4.75952 2.65385 4.50462 2.65385H4.5Z" fill="black"/>
          </svg>
        </div>
      `
            )
            .join("")}
        </div>
      `);
        let h = document.getElementById("pantsMeasurementWrapper");
        (h.style.position = "relative"),
          (h.style.display = "inline-block"),
          [
            "Waist",
            "Crotch Depth",
            "Seat",
            "Knee",
            "Inseam",
            "Hips",
            "Thigh",
            "Outseam",
            "Ankle",
          ].forEach((e) => {
            let t = document.getElementById(`${e}Input`);
            t.addEventListener("input", () => {
              d.measurements[e] = t.value;
            });
          });
        break;
      default:
        (x.style.display = "block"), console.log("Invalid step");
    }
  }
  (u = B()),
    A.runRenderLoop(() => u && u.render()),
    window.addEventListener("resize", () => A.resize());
  function K(e, t, a) {
    document.querySelectorAll(".card_cardImage.selected").forEach((e) => {
      e.classList.remove("selected");
    });
    let s = a.querySelector(".card_cardImage");
    s && s.classList.add("selected");
    let n = `./batch1/business/${t}.webp`;
    Z(n), (d.texture = `${t}.png`);
  }
  function Z(e) {
    if (!m || (m.diffuseTexture && m.diffuseTexture.name === e)) return;
    let t = new BABYLON.Texture(
      e,
      u,
      !1,
      !0,
      BABYLON.Texture.TRILINEAR_SAMPLINGMODE,
      () => {
        console.log(`Texture loaded: ${e}`);
      },
      (t, a) => {
        console.error(`Failed to load texture: ${e}`, t, a);
      }
    );
    (t.uScale = 5),
      (t.vScale = 5),
      (m.diffuseTexture = t),
      (m.diffuseTexture.name = e),
      (m.backFaceCulling = !1),
      (m.specularColor = new BABYLON.Color3(0, 0, 0)),
      (m.ambientColor = new BABYLON.Color3(1, 1, 1));
  }
  function Q() {
    console.log("[showMobileCutOptions] Displaying cut options...");
    let e = document.getElementById("textureContainer");
    e.innerHTML = "";
    let t = document.createElement("button");
    (t.textContent = "Confirm "),
      t.classList.add("back-to-cat"),
      t.addEventListener("click", () => {
        console.log("[showMobileCutOptions] Confirm clicked => returning"), X();
      }),
      e.appendChild(t);
    let a = document.createElement("div");
    (a.id = "mobileCutSlider"), a.classList.add("slider-container");
    let s = document.createElement("div");
    s.classList.add("cards-wrapper"),
      a.appendChild(s),
      [
        {
          src: "./assets/pants/cut/cut1.png",
          label: "Extra Slim",
          meshName: "cut1_mesh",
        },
        {
          src: "./assets/pants/cut/cut2.png",
          label: "Slim",
          meshName: "cut2_mesh",
        },
        {
          src: "./assets/pants/cut/cut3.png",
          label: "Straight",
          meshName: "cut3_mesh",
        },
        {
          src: "./assets/pants/cut/cut4.png",
          label: "Classic",
          meshName: "cut4_mesh",
        },
        {
          src: "./assets/pants/cut/cut5.png",
          label: "Relaxed Fit",
          meshName: "cut5_mesh",
        },
        {
          src: "./assets/pants/cut/cut6.png",
          label: "Tapered Leg",
          meshName: "cut6_mesh",
        },
        {
          src: "./assets/pants/cut/cut7.png",
          label: "Flat Front",
          meshName: "cut7_mesh",
        },
        {
          src: "./assets/pants/cut/cut8.png",
          label: "Pleated Front",
          meshName: "cut8_mesh",
        },
        {
          src: "./assets/pants/cut/cut9.png",
          label: "High waist",
          meshName: "cut9_mesh",
        },
        {
          src: "./assets/pants/cut/cut10.png",
          label: "Low rise",
          meshName: "cut10_mesh",
        },
      ].forEach((e) => {
        let t = document.createElement("div");
        t.classList.add("card_cardContainer", "part-option"),
          t.setAttribute("data-part-name", "Cut"),
          t.setAttribute("data-mesh-name", e.meshName),
          (t.tabIndex = 0),
          (t.style.touchAction = "pan-y"),
          (t.style.cursor = "pointer");
        let a = document.createElement("div");
        a.classList.add("img-wrapper"), (a.style.touchAction = "pan-y");
        let n = document.createElement("img");
        (n.src = e.src),
          (n.alt = e.label),
          (n.style.touchAction = "pan-y"),
          (n.style.width = "83px"),
          (n.style.height = "174px"),
          (n.style.objectFit = "contain"),
          a.appendChild(n);
        let i = document.createElement("p");
        (i.textContent = e.label),
          (i.style.touchAction = "pan-y"),
          t.appendChild(a),
          t.appendChild(i),
          t.addEventListener("click", () => {
            console.log("[showMobileCutOptions] Chosen cut:", e.label),
              s.querySelectorAll(".part-option").forEach((e) => {
                e.classList.remove("selected");
              }),
              t.classList.add("selected"),
              (d.design.pants.cut = e.meshName),
              el("Cut", e.meshName);
          }),
          s.appendChild(t);
      }),
      e.appendChild(a),
      G("#mobileCutSlider");
  }
  function ee(e) {
    let t = e.target.closest(".accordion"),
      a = e.target.closest(".sub_accordion");
    if (t) {
      console.log("[accordionClickHandler] Top-level accordion clicked:", t),
        t.classList.toggle("active");
      let s = t.querySelector(".sign-acc"),
        n = t.nextElementSibling;
      n.style.maxHeight && "0px" !== n.style.maxHeight
        ? ((n.style.maxHeight = "0px"),
          (s.innerHTML = "+"),
          console.log("[accordionClickHandler] Collapsing panel"))
        : ((n.style.maxHeight = "300px"),
          (s.innerHTML = "-"),
          console.log("[accordionClickHandler] Expanding panel")),
        document.querySelectorAll(".accordion").forEach((e) => {
          if (e !== t && e.classList.contains("active")) {
            e.classList.remove("active");
            let a = e.querySelector(".sign-acc"),
              s = e.nextElementSibling;
            s &&
              ((s.style.maxHeight = "0px"),
              (a.innerHTML = "+"),
              console.log(
                `[accordionClickHandler] Closing other accordion: ${e.getAttribute(
                  "data-category"
                )}`
              ));
          }
        }),
        _.removeAllMeshes();
      let i = t.getAttribute("data-category");
      console.log("[accordionClickHandler] Category is:", i),
        "jacket" === i
          ? (console.log("[accordionClickHandler] Loading Jacket options..."),
            et(),
            $.length > 0 || console.warn("No jacket meshes available to zoom."))
          : "pants" === i
          ? console.log("[accordionClickHandler] Loading Pants options...")
          : "vest" === i
          ? (console.log(
              "[accordionClickHandler] Vest option clicked. (Example only)"
            ),
            $.forEach((e) => e.setEnabled(!1)),
            k.forEach((e) => e.setEnabled(!1)),
            _.removeAllMeshes())
          : (console.log("[accordionClickHandler] Show all (fallback case)."),
            $.forEach((e) => e.setEnabled(!0)),
            k.forEach((e) => e.setEnabled(!0)),
            Object.keys(E).forEach((e) => {
              Object.keys(E[e]).forEach((t) => {
                let a = E[e][t];
                a && a.setEnabled(!0);
              });
            }),
            _.removeAllMeshes());
    } else if (a) {
      console.log("[accordionClickHandler] Sub-accordion clicked:", a),
        a.classList.toggle("active");
      let o = a.querySelector(".sign-acc"),
        r = a.nextElementSibling;
      r.style.maxHeight && "0px" !== r.style.maxHeight
        ? ((r.style.maxHeight = "0px"),
          (o.innerHTML = "+"),
          console.log("[accordionClickHandler] Collapsing sub-panel"))
        : ((r.style.maxHeight = r.scrollHeight + "px"),
          (o.innerHTML = "-"),
          console.log(
            "[accordionClickHandler] Expanding sub-panel to:",
            r.style.maxHeight
          ));
      let l = a.getAttribute("data-category");
      console.log("[accordionClickHandler] Sub-category is:", l),
        "cut" === l &&
          window.matchMedia("(max-width: 1024.9px)").matches &&
          (console.log(
            "[accordionClickHandler] 'Cut' was clicked on MOBILE -> Show mobile cut function"
          ),
          Q());
    }
  }
  function et() {
    Object.keys(E).forEach((e) => {
      let t = d.design.jacket[e];
      t &&
        Object.keys(E[e]).forEach((a) => {
          let s = E[e][a];
          s &&
            (s.setEnabled(a === t),
            a === t &&
              ((s.renderingGroupId = 2),
              (L[e] = s),
              _.addMesh(s, BABYLON.Color3.White())));
        });
    }),
      em(),
      Object.entries(d.design.jacket).forEach(([e, t]) => {
        if (!t) return;
        let a = document.querySelector(
          `.part-option[data-part-name="${e}"][data-mesh-name="${t}"]`
        );
        a && a.classList.add(eh(e, t));
      });
    let e = d.design.jacket.PocketsTop;
    if (e) {
      let t = document.querySelector(
        `.part-option[data-part-name="Pockets"][data-mesh-name="${e}"]`
      );
      t && t.classList.add("selected-top-pocket");
    }
    let a = d.design.jacket.PocketsBottom;
    if (a) {
      let s = document.querySelector(
        `.part-option[data-part-name="Pockets"][data-mesh-name="${a}"]`
      );
      s && s.classList.add("selected-bottom-pocket");
    }
    let n = d.design.jacket.Pockets;
    if (n) {
      Object.keys(E.Pockets).forEach((e) => {
        E.Pockets[e].setEnabled(!1);
      });
      let i = E.Pockets[n];
      i &&
        (i.setEnabled(!0),
        (L.Pockets = i),
        _.addMesh(i, BABYLON.Color3.White()));
    }
  }
  function ea(e) {
    let t = e.target.closest(".part-option");
    if (!t) return;
    let a = t.getAttribute("data-part-name"),
      s = t.getAttribute("data-mesh-name");
    if (!a || !s) {
      console.warn("Missing data-part-name or data-mesh-name attributes.");
      return;
    }
    if (
      !window.matchMedia("(max-width: 1024.9px)").matches ||
      "Pockets" !== a
    ) {
      if ("Pockets" === a) {
        let l = eh(a, s);
        if (t.classList.contains(l)) {
          t.classList.remove(l),
            (d.design.jacket.Pockets = void 0),
            es.includes(s)
              ? (d.design.jacket.PocketsTop = void 0)
              : en.includes(s) && (d.design.jacket.PocketsBottom = void 0),
            eo(s);
          return;
        }
      }
      if ((el(a, s), "Pockets" === a)) {
        let c = es.includes(s),
          p = en.includes(s);
        c
          ? es.forEach((e) => {
              let t = document.querySelector(
                `.part-option[data-mesh-name="${e}"]`
              );
              t && e !== s && t.classList.remove("selected-top-pocket");
            })
          : p &&
            en.forEach((e) => {
              let t = document.querySelector(
                `.part-option[data-mesh-name="${e}"]`
              );
              t && e !== s && t.classList.remove("selected-bottom-pocket");
            });
      } else
        document
          .querySelectorAll(`.part-option[data-part-name="${a}"]`)
          .forEach((e) => {
            e.classList.remove(
              "selected-back",
              "selected-lapel",
              "selected-top-pocket",
              "selected-bottom-pocket"
            );
          });
      if (
        (t.classList.add(eh(a, s)),
        "Back" === a
          ? (function e() {
              if (
                void 0 === n ||
                void 0 === i ||
                void 0 === o ||
                void 0 === r
              ) {
                console.error("Initial camera parameters are not set.");
                return;
              }
              let t = o + Math.PI;
              (t %= 2 * Math.PI),
                BABYLON.Animation.CreateAndStartAnimation(
                  "cameraRadiusResetBack",
                  h,
                  "radius",
                  60,
                  120,
                  h.radius,
                  n,
                  BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT
                ),
                BABYLON.Animation.CreateAndStartAnimation(
                  "cameraTargetResetBack",
                  h,
                  "target",
                  60,
                  120,
                  h.target,
                  i,
                  BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT
                ),
                BABYLON.Animation.CreateAndStartAnimation(
                  "cameraAlphaResetBack",
                  h,
                  "alpha",
                  60,
                  120,
                  h.alpha,
                  t,
                  BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT
                ),
                BABYLON.Animation.CreateAndStartAnimation(
                  "cameraBetaResetBack",
                  h,
                  "beta",
                  60,
                  120,
                  h.beta,
                  r,
                  BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT
                ),
                console.log(
                  "Camera reset to back view (rotated 180\xb0 relative to initial)."
                );
            })()
          : ("Lapels" === a || "Pockets" === a) && F(),
        ["Pockets"].includes(a))
      ) {
        let m = document.querySelector('.accordion[data-category="jacket"]');
        m && !m.classList.contains("active") ? m.click() : et();
      }
    }
  }
  let es = ["4on2_pocket_4", "4on2_pocket_5", "4on2_pocket_6"],
    en = [
      "4on2_pocket_1",
      "4on2_pocket_2",
      "4on2_pocket_3",
      "4on2_pocket_7",
      "4on2_pocket_8",
    ];
  function ei(e) {
    let t = [
        {
          src: "assets/jacket/pockets/jacketpockets.png",
          label: "Single Pocket",
          meshName: "4on2_pocket_1",
        },
        {
          src: "assets/jacket/pockets/jacketpockets.png",
          label: "Double Pocket",
          meshName: "4on2_pocket_2",
        },
        {
          src: "assets/jacket/pockets/jacketpockets.png",
          label: "Patch Pocket",
          meshName: "4on2_pocket_3",
        },
        {
          src: "assets/jacket/pockets/jacketpockets.png",
          label: "Flap Pocket",
          meshName: "4on2_pocket_4",
        },
        {
          src: "assets/jacket/pockets/jacketpockets.png",
          label: "Ticket Pocket",
          meshName: "4on2_pocket_5",
        },
        {
          src: "assets/jacket/pockets/jacketpockets.png",
          label: "Slash Pocket",
          meshName: "4on2_pocket_6",
        },
        {
          src: "assets/jacket/pockets/jacketpockets.png",
          label: "Welt Pocket",
          meshName: "4on2_pocket_7",
        },
        {
          src: "assets/jacket/pockets/jacketpockets.png",
          label: "Jetted Pocket",
          meshName: "4on2_pocket_8",
        },
      ],
      a;
    if (
      ("top" === e
        ? (a = t.filter((e) => es.includes(e.meshName)))
        : "bottom" === e && (a = t.filter((e) => en.includes(e.meshName))),
      "top" === e)
    ) {
      let s = document.getElementById("mobilePocketsContainer");
      if (!s) return;
      (s.innerHTML = ""),
        a.forEach((e) => {
          let t = document.createElement("div");
          t.classList.add("part-option", "card_cardContainer"),
            t.setAttribute("data-part-name", "Pockets"),
            t.setAttribute("data-mesh-name", e.meshName),
            (t.style.touchAction = "pan-y"),
            (t.style.cursor = "pointer"),
            d.design.jacket.PocketsTop === e.meshName &&
              t.classList.add("selected", "selected-top-pocket");
          let a = document.createElement("div");
          a.classList.add("img-wrapper"), (a.style.touchAction = "pan-y");
          let n = document.createElement("img");
          (n.src = e.src),
            (n.alt = e.label),
            (n.style.touchAction = "pan-y"),
            (n.style.width = "100%"),
            (n.style.height = "auto"),
            a.appendChild(n);
          let i = document.createElement("p");
          (i.textContent = e.label),
            (i.style.touchAction = "pan-y"),
            t.appendChild(a),
            t.appendChild(i),
            t.addEventListener("click", () => {
              console.log(
                "[renderMobilePocketsOptions] Chosen top pocket option:",
                e.label
              ),
                s.querySelectorAll(".part-option").forEach((e) => {
                  e.classList.remove("selected", "selected-top-pocket");
                }),
                t.classList.add("selected", "selected-top-pocket"),
                (d.design.jacket.PocketsTop = e.meshName),
                el("Pockets", e.meshName, "top"),
                F();
            }),
            s.appendChild(t);
        });
    } else if ("bottom" === e) {
      let n = document.getElementById("mobilePocketsSlider");
      if (n) n.innerHTML = "";
      else {
        ((n = document.createElement("div")).id = "mobilePocketsSlider"),
          n.classList.add("slider-container");
        let i = document.getElementById("mobilePocketsContainer");
        i && ((i.innerHTML = ""), i.appendChild(n));
      }
      let o = document.createElement("div");
      o.classList.add("cards-wrapper"),
        (o.id = "mobilePocketsSliderWrapper"),
        n.appendChild(o),
        a.forEach((e) => {
          let t = document.createElement("div");
          t.classList.add("part-option", "card_cardContainer"),
            t.setAttribute("data-part-name", "Pockets"),
            t.setAttribute("data-mesh-name", e.meshName),
            (t.style.touchAction = "pan-y"),
            (t.style.cursor = "pointer"),
            d.design.jacket.PocketsBottom === e.meshName &&
              t.classList.add("selected", "selected-bottom-pocket");
          let a = document.createElement("div");
          a.classList.add("img-wrapper"), (a.style.touchAction = "pan-y");
          let s = document.createElement("img");
          (s.src = e.src),
            (s.alt = e.label),
            (s.style.touchAction = "pan-y"),
            (s.style.width = "100%"),
            (s.style.height = "auto"),
            a.appendChild(s);
          let n = document.createElement("p");
          (n.textContent = e.label),
            (n.style.touchAction = "pan-y"),
            t.appendChild(a),
            t.appendChild(n),
            t.addEventListener("click", () => {
              console.log(
                "[renderMobilePocketsOptions] Chosen bottom pocket option:",
                e.label
              ),
                o.querySelectorAll(".part-option").forEach((e) => {
                  e.classList.remove("selected", "selected-bottom-pocket");
                }),
                t.classList.add("selected", "selected-bottom-pocket"),
                (d.design.jacket.PocketsBottom = e.meshName),
                el("Pockets", e.meshName, "bottom"),
                F();
            }),
            o.appendChild(t);
        }),
        o.removeAttribute("data-sliderInitialized"),
        G("#mobilePocketsSlider");
    }
  }
  function eo(e) {
    let t = document.querySelector(`.part-option[data-mesh-name="${e}"]`);
    t &&
      t.classList.remove(
        "selected-top-pocket",
        "selected-bottom-pocket",
        "selected-pockets",
        "selected-back",
        "selected-lapel"
      );
    let a = E.Pockets[e];
    a && a.setEnabled(!1);
  }
  function er(e) {
    let t = E.Pockets[e];
    t &&
      (t.setEnabled(!0),
      (t.renderingGroupId = 2),
      _.removeAllMeshes(),
      _.addMesh(t, BABYLON.Color3.White()));
    let a = document.querySelector(`.part-option[data-mesh-name="${e}"]`);
    if (a) {
      let s = "selected-pockets";
      es.includes(e)
        ? (s = "selected-top-pocket")
        : en.includes(e) && (s = "selected-bottom-pocket"),
        a.classList.remove(
          "selected-back",
          "selected-lapel",
          "selected-top-pocket",
          "selected-bottom-pocket"
        ),
        a.classList.add(s);
    }
  }
  function el(e, t, a) {
    if (!E[e]) {
      console.warn(
        `switchPartMesh: No mesh options available for part "${e}".`
      );
      return;
    }
    if ("Pockets" !== e) {
      Object.keys(E[e]).forEach((t) => {
        let a = E[e][t];
        a && a.setEnabled(!1);
      });
      let s = E[e][t];
      s
        ? (s.setEnabled(!0),
          (s.renderingGroupId = 2),
          (L[e] = s),
          (d.design.jacket[e] = t),
          Object.keys(E[e]).forEach((t) => {
            let a = E[e][t];
            a && _.removeMesh(a);
          }),
          _.addMesh(s, BABYLON.Color3.White()))
        : console.warn(
            `switchPartMesh: No mesh found for "${t}" in part "${e}".`
          );
      let n = document.querySelector(`.part-option[data-mesh-name="${t}"]`);
      n &&
        (n.classList.remove(
          "selected-back",
          "selected-lapel",
          "selected-top-pocket",
          "selected-bottom-pocket"
        ),
        n.classList.add(eh(e, t)));
      return;
    }
    if (window.matchMedia("(max-width: 1024.9px)").matches) {
      if ("top" === a) {
        es.forEach((e) => {
          let t = E.Pockets[e];
          t && (t.setEnabled(!1), _.removeMesh(t));
        });
        let i = E.Pockets[t];
        i
          ? (i.setEnabled(!0),
            (i.renderingGroupId = 2),
            (L.PocketsTop = i),
            (d.design.jacket.PocketsTop = t),
            es.forEach((e) => {
              let t = E.Pockets[e];
              t && _.removeMesh(t);
            }),
            _.addMesh(i, BABYLON.Color3.White()))
          : console.warn(
              `switchPartMesh: No top pocket mesh found for "${t}".`
            );
      } else if ("bottom" === a) {
        en.forEach((e) => {
          let t = E.Pockets[e];
          t && (t.setEnabled(!1), _.removeMesh(t));
        });
        let o = E.Pockets[t];
        o
          ? (o.setEnabled(!0),
            (o.renderingGroupId = 2),
            (L.PocketsBottom = o),
            (d.design.jacket.PocketsBottom = t),
            en.forEach((e) => {
              let t = E.Pockets[e];
              t && _.removeMesh(t);
            }),
            _.addMesh(o, BABYLON.Color3.White()))
          : console.warn(
              `switchPartMesh: No bottom pocket mesh found for "${t}".`
            );
      } else
        console.warn(
          "switchPartMesh (mobile): No mobileSelection provided for Pockets."
        );
    } else {
      let r = es.includes(t),
        l = en.includes(t);
      r
        ? d.design.jacket.PocketsTop === t
          ? ((d.design.jacket.PocketsTop = void 0),
            eo(t),
            _.removeMesh(E.Pockets[t]))
          : (es.forEach((e) => eo(e)), er(t), (d.design.jacket.PocketsTop = t))
        : l &&
          (d.design.jacket.PocketsBottom === t
            ? ((d.design.jacket.PocketsBottom = void 0),
              eo(t),
              _.removeMesh(E.Pockets[t]))
            : (en.forEach((e) => eo(e)),
              er(t),
              (d.design.jacket.PocketsBottom = t)));
    }
  }
  function ec(e) {}
  function ed(e) {
    let t = e.target.closest(".jacket-embroidery-choice");
    if (!t) return;
    let a = t.querySelector("p").innerText.trim();
    if ("No Embroidery" === a)
      (d.embroidery.jacket = []),
        document
          .querySelectorAll(".jacket-embroidery-choice")
          .forEach((e) => e.classList.remove("selected")),
        t.classList.add("selected");
    else {
      let s = d.embroidery.jacket.findIndex((e) => e.location === a);
      if (
        (-1 === s
          ? (d.embroidery.jacket.push({ location: a, text: "", color: null }),
            t.classList.add("selected"))
          : (d.embroidery.jacket.splice(s, 1), t.classList.remove("selected")),
        d.embroidery.jacket.length > 0)
      ) {
        let n = document.querySelector(
          ".jacket-embroidery-choice.no-embroidery"
        );
        n && n.classList.remove("selected");
      } else {
        let i = document.querySelector(
          ".jacket-embroidery-choice.no-embroidery"
        );
        i && i.classList.add("selected");
      }
    }
    d.embroidery.hasEmbroidery = d.embroidery.jacket.length > 0;
    let o = document.querySelector(".characters-inputs");
    o && "none" !== o.style.display && (eg(), (o.style.display = "block"));
  }
  function ep(e, t) {
    (e = gsap.utils.toArray(e)), (t = t || {});
    let a = gsap.timeline({
        repeat: t.repeat,
        paused: t.paused,
        defaults: { ease: "none" },
        onReverseComplete: () => a.totalTime(a.rawTime() + 100 * a.duration()),
      }),
      s = e.length,
      n = e[0].offsetLeft,
      i = [],
      o = [],
      r = [],
      l = 0,
      c = 100 * (t.speed || 1),
      d = !1 === t.snap ? (e) => e : gsap.utils.snap(t.snap || 1),
      p = () =>
        e.forEach((e, t) => {
          (o[t] = parseFloat(gsap.getProperty(e, "width", "px"))),
            (r[t] = d(
              (parseFloat(gsap.getProperty(e, "x", "px")) / o[t]) * 100 +
                gsap.getProperty(e, "xPercent")
            ));
        }),
      m = () =>
        e[s - 1].offsetLeft +
        (r[s - 1] / 100) * o[s - 1] -
        n +
        e[s - 1].offsetWidth * gsap.getProperty(e[s - 1], "scaleX") +
        (parseFloat(t.paddingRight) || 0),
      u,
      g,
      h,
      $,
      k,
      b;
    for (
      p(),
        gsap.set(e, { xPercent: (e) => r[e] }),
        gsap.set(e, { x: 0 }),
        u = m(),
        b = 0;
      b < s;
      b++
    )
      (k = e[b]),
        (g = (r[b] / 100) * o[b]),
        ($ = (h = k.offsetLeft + g - n) + o[b] * gsap.getProperty(k, "scaleX")),
        a
          .to(k, { xPercent: d(((g - $) / o[b]) * 100), duration: $ / c }, 0)
          .fromTo(
            k,
            { xPercent: d(((g - $ + u) / o[b]) * 100) },
            {
              xPercent: r[b],
              duration: (g - $ + u - g) / c,
              immediateRender: !1,
            },
            $ / c
          )
          .add("label" + b, h / c),
        (i[b] = h / c);
    function y(e, t) {
      (t = t || {}), Math.abs(e - l) > s / 2 && (e += e > l ? -s : s);
      let n = gsap.utils.wrap(0, s, e),
        o = i[n];
      return (
        o > a.time() != e > l &&
          ((t.modifiers = { time: gsap.utils.wrap(0, a.duration()) }),
          (o += a.duration() * (e > l ? 1 : -1))),
        (l = n),
        (t.overwrite = !0),
        a.tweenTo(o, t)
      );
    }
    if (
      ((a.next = (e) => y(l + 1, e)),
      (a.previous = (e) => y(l - 1, e)),
      (a.current = () => l),
      (a.toIndex = (e, t) => y(e, t)),
      (a.updateIndex = () => (l = Math.round(a.progress() * e.length))),
      (a.times = i),
      (a.items = e),
      a.progress(1, !0).progress(0, !0),
      t.reversed && (a.vars.onReverseComplete(), a.reverse()),
      t.draggable && "function" == typeof Draggable)
    ) {
      let _ = document.createElement("div"),
        v = gsap.utils.wrap(0, 1),
        f,
        E,
        C,
        L,
        x,
        A = () => a.progress(v(E + (C.startX - C.x) * f)),
        w = () => a.updateIndex();
      "undefined" == typeof InertiaPlugin &&
        console.warn(
          "InertiaPlugin required for momentum-based scrolling and snapping. https://greensock.com/club"
        ),
        (C = Draggable.create(_, {
          trigger: e[0].parentNode,
          type: "x",
          onPress() {
            (E = a.progress()),
              a.progress(0),
              p(),
              (f = 1 / (u = m())),
              (x = Math.pow(
                10,
                (((L = u / e.length) + "").split(".")[1] || "").length
              )),
              a.progress(E);
          },
          onDrag: A,
          onThrowUpdate: A,
          inertia: !0,
          snap(e) {
            let t = Math.round(parseFloat(e) / L) * L * x;
            return (t - (t % 1)) / x;
          },
          onRelease: w,
          onThrowComplete: () => gsap.set(_, { x: 0 }) && w(),
        })[0]);
    }
    return a;
  }
  function em() {
    h.inputs.attached.keyboard || h.attachControl(x, !0),
      console.log("Camera controls enabled.");
  }
  function eu() {
    let e = document.querySelectorAll(".cards-wrapper");
    e.forEach((e) => {
      if (e.dataset.sliderInitialized) return;
      let t = gsap.utils.toArray(".card_cardContainer", e),
        a = ep(t, { paused: !0, draggable: !0, speed: 2, snap: 1 });
      a.progress(0, !1),
        gsap.set(e, { x: 0 }),
        (e.dataset.sliderInitialized = "true");
    });
  }
  function eg() {
    let e = document.querySelector(".characters-inputs");
    if ((e && e.remove(), 0 === d.embroidery.jacket.length)) return;
    if (!v && !(v = document.getElementById("embroideryLocationsContainer"))) {
      console.error(
        "Element with ID 'embroideryLocationsContainer' not found."
      );
      return;
    }
    let t = document.createElement("div");
    t.classList.add("characters-inputs");
    let a = '<h3 class="embroidery-text">Embroidery Text:</h3>';
    d.embroidery.jacket.forEach((e, t) => {
      a += `
      <div class="embroidery-input-group">
        <input
          class="embroidery-input"
          placeholder="${e.location} Enter your initials"
          type="text"
          id="embroideryTextInput${t}"
          maxlength="20"
          value="${e.text || ""}"
        />
      </div>
    `;
    }),
      (t.innerHTML = a),
      v.appendChild(t),
      d.embroidery.jacket.forEach((e, t) => {
        let a = document.getElementById(`embroideryTextInput${t}`);
        a &&
          a.addEventListener("input", () => {
            e.text = a.value.trim();
          });
      });
  }
  function eh(e, t) {
    switch (e) {
      case "Back":
        return "selected-back";
      case "Lapels":
        return "selected-lapel";
      case "Pockets":
        if (es.includes(t)) return "selected-top-pocket";
        if (en.includes(t)) return "selected-bottom-pocket";
        return "selected-pockets";
      default:
        return "selected";
    }
  }
  document.getElementById("backButton").addEventListener("click", function () {
    F(),
      em(),
      c > 1 &&
        (5 === c ? (c = 0 === d.embroidery.jacket.length ? 3 : 4) : c--,
        J(c),
        em());
  }),
    document
      .getElementById("nextButton")
      .addEventListener("click", function () {
        em(), F();
        let t = null;
        if (1 === c) {
          let a = document.querySelector(".card_cardImage.selected");
          a
            ? ((t = { texture: a.alt }), (d.texture = a.alt))
            : ((t = { texture: "E5102-38.webp" }),
              (d.texture = "E5102-38.webp"));
        } else if (2 === c) t = { design: d.design };
        else if (3 === c) t = { jacketEmbroidery: d.embroidery.jacket };
        else if (4 === c)
          t = { jacketEmbroideryCustomizations: d.embroidery.jacket };
        else if (5 === c) {
          (function e() {
            for (let t of [
              "Waist",
              "Crotch Depth",
              "Seat",
              "Knee",
              "Inseam",
              "Hips",
              "Thigh",
              "Outseam",
              "Ankle",
            ])
              if (
                !d.measurements ||
                !d.measurements[t] ||
                "" === d.measurements[t]
              )
                return !1;
            return !0;
          })()
            ? J(++c)
            : alert("Please fill in all measurements before proceeding.");
          return;
        }
        console.log("Current Step: ", c),
          console.log("Selected Choice: ", t),
          console.log("User Choices: ", d),
          c < 5
            ? (3 === c && 0 === d.embroidery.jacket.length ? (c = 5) : c++,
              J(c))
            : 5 === c ||
              (function t() {
                let a =
                  "Configuration Complete! Thank you for customizing your suit.\n\n";
                for (let s in ((a += `Texture: ${d.texture}
`),
                (a += "Design Selections:\n"),
                d.design.jacket))
                  a += `  ${s}: ${d.design.jacket[s]}
`;
                for (let n in d.design.pants)
                  a += `  ${n}: ${d.design.pants[n]}
`;
                if (
                  (d.embroidery.hasEmbroidery && d.embroidery.jacket.length > 0
                    ? ((a += "Embroidery Locations:\n"),
                      d.embroidery.jacket.forEach((e, t) => {
                        (a += `  Embroidery ${t + 1}:
`),
                          (a += `    Location: ${e.location}
`),
                          (a += `    Text: ${e.text || "N/A"}
`),
                          (a += `    Color: ${e.color || "N/A"}
`);
                      }))
                    : (a += "No Embroidery Selected.\n"),
                  d.embroidery.threadColor &&
                    (a += `Thread Color (Mobile): ${d.embroidery.threadColor}
`),
                  d.measurements)
                )
                  for (let i in ((a += "Measurements:\n"), d.measurements))
                    a += `  ${i}: ${d.measurements[i]}
`;
                alert(a), e.sendUserChoicesEmail(d);
              })();
      }),
    document
      .getElementById("textureContainer")
      .addEventListener("click", function (e) {
        if (e.target.classList.contains("card_cardImage"));
        else if (e.target.closest(".pants-item img")) {
          document
            .querySelectorAll(".pants-item img")
            .forEach((e) => e.classList.remove("selected")),
            e.target.closest(".pants-item img").classList.add("selected");
          let t = e.target.closest(".pants-item img").alt;
          d.design.pants.Pockets = t;
        }
      }),
    fetch("textures.json")
      .then((e) => e.json())
      .then((e) => {
        (l = e),
          (function e() {
            if (I) return;
            I = !0;
            let t = document.getElementById("textureContainer");
            t.addEventListener("click", ee);
          })(),
          (function e() {
            if (P) return;
            P = !0;
            let t = document.getElementById("textureContainer");
            t.addEventListener("click", ea);
          })(),
          (function e() {
            if (M) return;
            M = !0;
            let t = document.getElementById("textureContainer");
            t.addEventListener("click", ec);
          })(),
          (function e() {
            if (T) return;
            T = !0;
            let t = document.getElementById("textureContainer");
            t.addEventListener("click", ed);
          })();
      })
      .catch((e) => console.error("Error loading textures.json:", e)),
    (t = !0),
    (a = !0),
    $.forEach((e) => e.setEnabled(t)),
    k.forEach((e) => e.setEnabled(a));
  let e$ = document.getElementById("arrow");
  e$
    ? e$.addEventListener("click", () => {
        !(function e(t) {
          let a = g.rotation.y + t,
            s = new BABYLON.Animation(
              "rotateAnimation",
              "rotation.y",
              60,
              BABYLON.Animation.ANIMATIONTYPE_FLOAT,
              BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE
            ),
            n = [
              { frame: 0, value: g.rotation.y },
              { frame: 120, value: a },
            ];
          s.setKeys(n),
            (g.animations = []),
            g.animations.push(s),
            u.beginAnimation(g, 0, 120, !1, 1, () => {}),
            (g.rotation.y = a),
            console.log(`Model rotated to Y=${a}`);
        })(Math.PI / 2);
      })
    : console.warn('Arrow element with id "arrow" not found.'),
    document.getElementById("resetCameraButton").addEventListener("click", F);
});
